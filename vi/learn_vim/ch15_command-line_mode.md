# Ch15. Command-line Mode
지난 세 장에서 검색 명령어(`/`, `?`), 치환 명령어(`:s`), 전역 명령어(`:g`), 외부 명령어(`!`) 사용법을 배웠습니다. 이들은 명령줄 모드 명령어의 예입니다.

이번 장은 명령줄 모드에 대한 다양한 팁과 요령을 배웁니다.


## Entering and Exiting the Command-line Mode
명령줄 모드는 일반 모드, 삽입 모드, 시각 모드와 마찬가지로 독립된 모드입니다. 이 모드는 커서가 화면 하단으로 이동해서 다양한 명령어를 입력할 수 있습니다.

명령줄 모드로 진입하는 데 사용할 수 있는 4가지 명령어는 다음과 같습니다:

- 검색 패턴 (`/`, `?`)
- 명령줄 명령어 (`:`)
- 외부 명령어 (`!`)

명령줄 모드는 일반 모드나 시각 모드에서 진입할 수 있습니다.

명령줄 모드를 종료하려면 `<Esc>`, `Ctrl-C` 또는 `Ctrl-[` 를 사용합니다.

**다른 문헌에는 “명령줄 명령어” 를 “Ex 명령어” 로, “외부 명령어” 를 “필터 명령어” 또는 “뱅 연산자” 로 표기할 수 있습니다.**


## Repeating the Previous Command
이전 명령줄 명령이나 외부 명령을 `@:` 로 반복할 수 있습니다.

`:s/foo/bar/g` 를 실행한 직후 `@:` 를 실행하면 해당 치환이 반복됩니다. `:.!tr ‘[a-z]’ '[A-Z]'` 를 실행한 직후 `@:` 를 실행하면 마지막 외부 명령 변환 필터가 반복됩니다.


## Command-line Mode Shortcuts
명령줄 모드는 `왼쪽` 또는 `오른쪽` 화살표 키를 사용해서 한 글자씩 좌우로 이동할 수 있습니다.

단어 단위로 이동하려면 `Shift-왼쪽` 또는 `Shift-오른쪽`을 사용합니다. (일부 OS는 `Shift` 대신 `Ctrl` 을 사용할 수 있습니다.)

줄의 시작 부분으로 이동하려면 `Ctrl-B`를, 줄의 끝 부분으로 이동하려면 `Ctrl-E`를 사용합니다.

삽입 모드와 마찬가지로 명령줄 모드 내에서도 문자를 삭제하는 세 가지 방법이 있습니다:

```
Ctrl-H    한 글자 삭제
Ctrl-W    한 단어 삭제
Ctrl-U    전체 줄 삭제
```

마지막으로, 일반 텍스트 파일처럼 명령어를 편집하려면 `Ctrl-F` 를 사용합니다.

이를 통해 이전 명령어를 검색하고 편집한 후 “명령줄 편집 일반 모드” 에서 `<Enter>` 를 눌러 재실행할 수 있습니다.


## Register and Autocomplete
명령줄 모드는 삽입 모드와 동일한 방식으로 `Ctrl-R` 을 사용해서 Vim 레지스터의 텍스트를 삽입할 수 있습니다. 레지스터 a에 “foo” 문자열이 저장되어 있다면 `Ctrl-R a` 를 실행해서 삽입할 수 있습니다. 삽입 모드에서 레지스터를 통해 수행할 수 있는 모든 작업은 명령줄 모드도 동일하게 가능합니다.

또한, 커서 단어를 `Ctrl-R Ctrl-W` 로, 커서 단어를 `Ctrl-R Ctrl-A` 로 가져올 수 있습니다. 커서 아래 줄을 가져오려면 `Ctrl-R Ctrl-L` 을, 커서 아래 파일명을 가져오려면 `Ctrl-R Ctrl-F` 를 사용합니다.

기존 명령어의 자동 완성도 사용 가능합니다. 명령줄 모드에서 `echo` 명령어를 자동 완성하려면 “ec” 를 입력한 후 `<Tab>` 을 누릅니다. 화면 좌측 하단에 “ec” 로 시작하는 Vim 명령어 목록(예: `echo echoerr echohl echomsg econ`)이 표시됩니다. 다음 옵션으로 이동하려면 `<Tab>` 또는 `Ctrl-N` 을 누릅니다. 이전 옵션으로 이동하려면 `<Shift-Tab>` 또는 `Ctrl-P` 를 누릅니다.

일부 명령줄 명령어는 파일 이름을 인수로 받습니다. `edit` 명령이 그 예입니다. 여기도 자동완성이 가능합니다. 명령어 `:e ` (공백 포함)을 입력한 후 `<Tab>` 을 누릅니다. Vim이 선택 가능한 관련 파일 이름을 모두 나열하므로 처음부터 입력할 필요가 없습니다.


## History Window and Command-line Window
명령줄 명령어 및 검색어의 기록을 확인할 수 있습니다. (이를 위해서는 `+cmdline_hist` 기능이 필요합니다.)

명령줄 기록을 열려면 `:his :` 를 실행합니다. 다음과 같은 내용이 표시됩니다:

```
## Cmd history
2  e file1.txt
3  g/foo/d
4  s/foo/bar/g
```

Vim은 실행한 모든 `:` 명령어의 기록을 나열합니다. 기본적으로 Vim은 마지막 50개의 명령어를 저장합니다. Vim이 기억하는 항목 수를 100개로 변경하려면 `set history=100` 을 실행합니다.

명령줄 기록을 좀 더 유용하게 활용하는 방법은 명령줄 창(`q:`)을 이용하는 것입니다. 이 명령은 검색 및 편집이 가능한 기록 창을 엽니다. `q:` 를 누를 때 기록에 다음과 같은 표현이 있다고 가정해 보겠습니다:

```
51  s/verylongsubstitutionpattern/pancake/g
52  his :
53  wq
```

현재 작업이 `s/verylongsubstitutionpattern/donut/g` 를 수행하는 것이라면, 명령어를 처음부터 입력하는 대신 `s/verylongsubstitutionpattern/pancake/g` 를 재사용합니다. 결국 다른 점은 대체할 단어(“donut” 대 “pancake”)뿐입니다. 나머지는 모두 동일합니다.

`q:` 를 실행한 후, 히스토리에서 `s/verylongsubstitutionpattern/pancake/g` 를 찾습니다. (이 환경에서 Vim 탐색 기능을 사용할 수 있습니다.) 그리고 직접 편집합니다! 히스토리 창 안에서 “pancake” 를 “donut” 로 변경한 후 `<Enter>` 를 누릅니다. 짠! Vim이 `s/verylongsubstitutionpattern/donut/g` 를 대신 실행해 줍니다. 정말 편리하죠!

마찬가지로 검색 기록을 보려면 `:his /` 또는 `:his ?` 를 실행합니다. 과거 기록을 검색하고 편집할 수 있는 검색 기록 창을 열려면 `q/` 또는 `q?` 를 실행합니다.

이 창을 종료하려면 `Ctrl-C`, `Ctrl-W C` 를 누르거나 `:quit` 을 입력합니다.


## More Command-line Commands
Vim에는 수백 개의 내장 명령어가 있습니다. Vim의 모든 명령어를 보려면 `:h ex-cmd-index` 또는 `:h :index` 를 확인합니다.


## Learn Command-line Mode the Smart Way
다른 세 가지 모드와 비교했을 때, 명령줄 모드는 텍스트 편집의 스위스 군용 칼과 같습니다. 텍스트 편집, 파일 수정, 명령어 실행 등 다양한 작업을 수행할 수 있습니다. 이 장은 명령줄 모드의 잡다한 기능들을 모아놓은 것입니다. 또한, Vim 모드에 대한 설명은 마무리합니다. 이제 일반 모드, 삽입 모드, 시각 모드, 명령줄 모드 사용법을 알게 되었으니 Vim으로 그 어느 때보다 빠르게 텍스트를 편집할 수 있습니다.

이제 Vim 모드에서 벗어나서 Vim 태그를 활용한 빠른 탐색 방법을 배울 때입니다.



## Link
- Prev [Ch14. External Commands](./ch14_external_commands.md)
- Next [Ch16. Tags](./ch16_tags.md)
